<!--
@game-meta
{
  "id": "zombie-arena",
  "title": "ì¢€ë¹„ ì•„ë ˆë‚˜",
  "emoji": "ğŸ§Ÿ",
  "category": "ì„œë°”ì´ë²Œ",
  "description": "ì¢€ë¹„ë¥¼ í”¼í•´ ìƒì¡´í•˜ì„¸ìš”! ì˜ì—­ì´ ì ì  ì¶•ì†Œë©ë‹ˆë‹¤.",
  "features": ["ğŸ”¥ ì˜ì—­ ì¶•ì†Œ", "ğŸ‘ï¸ ì‹œì•¼ ì‹œìŠ¤í…œ"],
  "color": "zombie",
  "badge": null,
  "version": "1.2.0",
  "updated": "2025-01-15",
  "author": {
    "name": "Euiyun Edwin Kim",
    "email": "geniuskey@gmail.com",
    "github": "geniuskey"
  },
  "urls": {
    "service": "https://geniuskey.github.io/lottery/zombie-arena/",
    "repository": "https://github.com/geniuskey/lottery"
  },
  "license": "MIT",
  "copyright": "Â© 2025 Euiyun Edwin Kim. Licensed under the MIT License."
}
@end-game-meta
-->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜</title>
    
    <!-- SEO ê¸°ë³¸ -->
    <meta name="description" content="ì¢€ë¹„ë¥¼ í”¼í•´ ìƒì¡´í•˜ì„¸ìš”! ì˜ì—­ì´ ì ì  ì¶•ì†Œë©ë‹ˆë‹¤.">
    <meta name="author" content="Euiyun Edwin Kim">
    <meta name="keywords" content="ì¢€ë¹„ ì•„ë ˆë‚˜, ì¢€ë¹„, ì„œë°”ì´ë²Œ, ì¶”ì²¨, ê²Œì„, lottery, zombie, arena">
    
    <!-- Open Graph (ì¹´ì¹´ì˜¤í†¡, í˜ì´ìŠ¤ë¶, ìŠ¬ë™ ë“±) -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="ì¶”ì²¨ ê²Œì„ í¬íƒˆ">
    <meta property="og:title" content="ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜">
    <meta property="og:description" content="ì¢€ë¹„ë¥¼ í”¼í•´ ìƒì¡´í•˜ì„¸ìš”! ì˜ì—­ì´ ì ì  ì¶•ì†Œë©ë‹ˆë‹¤.">
    <meta property="og:url" content="https://geniuskey.github.io/lottery/zombie-arena/">
    <meta property="og:locale" content="ko_KR">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜">
    <meta name="twitter:description" content="ì¢€ë¹„ë¥¼ í”¼í•´ ìƒì¡´í•˜ì„¸ìš”! ì˜ì—­ì´ ì ì  ì¶•ì†Œë©ë‹ˆë‹¤.">
    
    <!-- ì¶”ê°€ SEO -->
    <link rel="canonical" href="https://geniuskey.github.io/lottery/zombie-arena/">
    <meta name="robots" content="index, follow">
    
    <!-- í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
:root{--bg-dark:#0a0a0a;--bg-card:rgba(20,20,20,0.95);--glass-bg:rgba(255,255,255,0.03);--glass-border:rgba(255,255,255,0.08);--text-primary:#fff;--text-secondary:rgba(255,255,255,0.6);--accent-red:#ff4444;--accent-green:#4CAF50;--accent-gold:#ffd700}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans KR',sans-serif;background:var(--bg-dark);color:var(--text-primary);min-height:100vh;overflow:hidden}
.container{display:flex;height:100vh;width:100vw}
.sidebar{width:280px;min-width:280px;background:var(--bg-card);border-right:1px solid var(--glass-border);display:flex;flex-direction:column;overflow-y:auto}
.sidebar-header{padding:15px;border-bottom:1px solid var(--glass-border)}
.logo-row{display:flex;justify-content:space-between;align-items:center}
.logo{font-family:'Black Han Sans',sans-serif;font-size:1.3rem;color:var(--accent-red);text-shadow:0 0 20px rgba(255,68,68,0.5)}
.header-controls{display:flex;align-items:center;gap:8px}
.lang-select{background:rgba(0,0,0,0.3);border:1px solid var(--glass-border);color:var(--text-primary);padding:4px 8px;border-radius:4px;font-size:0.7rem;cursor:pointer}
.help-btn{background:rgba(255,255,255,0.1);border:none;color:var(--text-secondary);width:28px;height:28px;border-radius:50%;cursor:pointer;font-size:0.9rem;transition:all 0.2s}
.help-btn:hover{background:rgba(255,255,255,0.2);color:var(--text-primary)}
.sidebar-content{padding:15px;flex:1;display:flex;flex-direction:column;min-height:0}
.section{margin-bottom:15px}
.section-title{font-size:0.75rem;color:var(--text-secondary);margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}
.participants-input{width:100%;height:80px;background:var(--glass-bg);border:1px solid var(--glass-border);border-radius:8px;color:var(--text-primary);padding:10px;font-size:0.85rem;resize:none;font-family:inherit}
.participants-input::placeholder{color:var(--text-secondary)}
.participants-input:focus{outline:none;border-color:var(--accent-red)}
.hint{font-size:0.65rem;color:var(--text-secondary);margin-top:5px}
.slider-group{margin-bottom:12px}
.slider-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.slider-label{font-size:0.8rem;color:var(--text-secondary)}
.slider-value{font-size:0.9rem;font-weight:bold;color:var(--accent-red)}
input[type="range"]{width:100%;height:4px;border-radius:2px;background:var(--glass-border);-webkit-appearance:none;cursor:pointer}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:var(--accent-red);cursor:pointer}
.btn-group{display:flex;gap:8px;margin-top:15px}
.btn{flex:1;padding:12px;border:none;border-radius:8px;font-family:inherit;font-size:0.9rem;font-weight:bold;cursor:pointer;transition:all 0.2s}
.btn-primary{background:linear-gradient(135deg,var(--accent-red),#cc0000);color:#fff}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(255,68,68,0.4)}
.btn-secondary{background:var(--glass-bg);border:1px solid var(--glass-border);color:var(--text-primary);flex:0 0 50px}
.btn-secondary:hover{background:rgba(255,255,255,0.1)}
.ranking-section{background:var(--glass-bg);border:1px solid var(--glass-border);border-radius:8px;padding:12px;flex:1;overflow-y:auto;min-height:0}
.ranking-title{font-size:0.8rem;color:var(--text-secondary);margin-bottom:10px;display:flex;align-items:center;gap:5px}
.ranking-list{display:flex;flex-direction:column;gap:4px}
.ranking-item{display:flex;align-items:center;padding:6px 8px;border-radius:4px;font-size:0.75rem;background:rgba(255,255,255,0.03)}
.ranking-item.infected{background:rgba(255,50,50,0.15);border-left:2px solid var(--accent-red)}
.ranking-item.survivor{background:rgba(50,255,50,0.15);border-left:2px solid var(--accent-green)}
.ranking-item.winner{background:linear-gradient(135deg,rgba(255,215,0,0.3),rgba(255,150,0,0.3));border-left:2px solid gold}
.ranking-divider{border-top:1px dashed rgba(255,255,255,0.2);margin:8px 0}
.ranking-rank{width:24px;font-weight:bold;color:var(--text-secondary)}
.ranking-name{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ranking-status{font-size:0.65rem;color:var(--text-secondary)}
.ranking-placeholder{text-align:center;color:var(--text-secondary);font-size:0.75rem;padding:20px}
.sidebar-footer{padding:15px;border-top:1px solid var(--glass-border);display:flex;justify-content:center;gap:10px}
.icon-btn{width:36px;height:36px;border-radius:8px;background:var(--glass-bg);border:1px solid var(--glass-border);color:var(--text-secondary);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;text-decoration:none}
.icon-btn:hover{background:rgba(255,255,255,0.1);color:var(--text-primary);transform:translateY(-2px)}
[data-tooltip]{position:relative}
[data-tooltip]:hover::after{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translateX(-50%);padding:5px 10px;background:rgba(0,0,0,0.9);color:#fff;font-size:0.7rem;border-radius:4px;white-space:nowrap;margin-bottom:5px}
.game-area{flex:1;display:flex;flex-direction:column;background:#0a0f0a;position:relative}
.arena-header{display:grid;grid-template-columns:auto 1fr auto auto;align-items:center;padding:10px 15px;background:rgba(0,0,0,0.5);border-bottom:1px solid var(--glass-border);gap:15px}
.shrink-warning{background:linear-gradient(90deg,transparent,rgba(255,0,0,0.3),transparent);color:var(--accent-red);font-weight:bold;font-size:0.8rem;animation:pulse 0.5s ease-in-out infinite;display:none}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
.timer-display{font-family:'Black Han Sans',sans-serif;font-size:1.5rem;color:var(--accent-green);text-shadow:0 0 10px rgba(76,175,80,0.5);justify-self:center}
.status-bar{display:flex;gap:15px;font-size:0.9rem;justify-self:end}
.status-item{display:flex;align-items:center;gap:5px}
.status-item.humans{color:var(--accent-green)}
.status-item.zombies{color:var(--accent-red)}
.canvas-wrapper{flex:1;position:relative;overflow:hidden}
#gameCanvas{width:100%;height:100%;display:block}
.copyright{position:absolute;bottom:10px;right:15px;font-size:0.7rem;color:rgba(255,255,255,0.25);pointer-events:none;user-select:none}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:all 0.3s}
.modal.show{opacity:1;visibility:visible}
.modal-content{background:var(--bg-card);border:1px solid var(--glass-border);border-radius:16px;padding:25px;max-width:400px;width:90%;max-height:80vh;overflow-y:auto}
.modal-title{font-family:'Black Han Sans',sans-serif;font-size:1.5rem;margin-bottom:20px;text-align:center}
.help-section{margin-bottom:15px}
.help-section h3{font-size:0.9rem;color:var(--accent-red);margin-bottom:8px}
.help-section p{font-size:0.8rem;color:var(--text-secondary);line-height:1.6}
.modal-btn{width:100%;padding:12px;background:linear-gradient(135deg,var(--accent-red),#cc0000);border:none;border-radius:8px;color:#fff;font-family:inherit;font-size:1rem;font-weight:bold;cursor:pointer;margin-top:15px}
.winner-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:all 0.5s}
.winner-overlay.show{opacity:1;visibility:visible}
.winner-title{font-family:'Black Han Sans',sans-serif;font-size:2rem;color:var(--accent-gold);text-shadow:0 0 30px rgba(255,215,0,0.8);margin-bottom:20px;animation:glow 1s ease-in-out infinite alternate}
@keyframes glow{from{text-shadow:0 0 20px rgba(255,215,0,0.5)}to{text-shadow:0 0 40px rgba(255,215,0,1),0 0 60px rgba(255,215,0,0.5)}}
.winner-name{font-family:'Black Han Sans',sans-serif;font-size:3rem;color:#fff;margin-bottom:10px}
.winner-stats{font-size:1rem;color:var(--text-secondary);margin-bottom:30px}
.winner-overlay .modal-btn{width:auto;padding:12px 40px;font-size:0.9rem}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--bg-card);border:1px solid var(--glass-border);padding:12px 24px;border-radius:8px;font-size:0.9rem;transition:transform 0.3s;z-index:2000}
.toast.show{transform:translateX(-50%) translateY(0)}
@media(max-width:768px){.container{flex-direction:column}.sidebar{width:100%;min-width:unset;max-height:45vh;border-right:none;border-bottom:1px solid var(--glass-border)}.game-area{min-height:55vh}.winner-name{font-size:2rem}.winner-title{font-size:1.5rem}}
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-row">
                    <span class="logo" data-i18n="title">ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜</span>
                    <div class="header-controls">
                        <select class="lang-select" id="langSelect"><option value="ko">í•œêµ­ì–´</option><option value="en">English</option><option value="zh">ä¸­æ–‡</option></select>
                        <button class="help-btn" id="helpBtn">?</button>
                    </div>
                </div>
            </div>
            <div class="sidebar-content">
                <div class="section">
                    <div class="section-title" data-i18n="participants">ì°¸ì—¬ì ëª…ë‹¨</div>
                    <textarea class="participants-input" id="participants" data-placeholder-i18n="participantsPlaceholder" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”&#10;ì˜ˆ: ì² ìˆ˜, ì˜í¬, ë¯¼ìˆ˜">ì˜ìˆ˜, ì˜í˜¸, ì˜ì‹, ì˜ì² , ê´‘ìˆ˜, ìƒì² </textarea>
                    <div class="hint" data-i18n="hint">ì‰¼í‘œ ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„</div>
                </div>
                <div class="section">
                    <div class="slider-group">
                        <div class="slider-header"><span class="slider-label" data-i18n="initialZombies">ğŸ§Ÿ ì´ˆê¸° ì¢€ë¹„ ìˆ˜</span><span class="slider-value" id="zombieValue">2</span></div>
                        <input type="range" id="zombieCount" min="1" max="5" value="2">
                    </div>
                    <div class="slider-group">
                        <div class="slider-header"><span class="slider-label" data-i18n="survivors">ğŸ† ìµœì¢… ìƒì¡´ì ìˆ˜</span><span class="slider-value" id="survivorValue">1</span></div>
                        <input type="range" id="survivorCount" min="1" max="5" value="1">
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" id="startBtn" data-i18n="start">ğŸ® ì‹œì‘</button>
                    <button class="btn btn-secondary" id="resetBtn">â†º</button>
                </div>
                <div class="section" style="margin-top:15px;flex:1;display:flex;flex-direction:column;min-height:0">
                    <div class="ranking-section">
                        <div class="ranking-title" data-i18n="infectionOrder">ğŸ† ê°ì—¼ ìˆœì„œ</div>
                        <div class="ranking-list" id="rankingList"><div class="ranking-placeholder" data-i18n="rankingPlaceholder">ê²Œì„ì„ ì‹œì‘í•˜ë©´<br>ê°ì—¼ ìˆœì„œê°€ í‘œì‹œë©ë‹ˆë‹¤</div></div>
                    </div>
                </div>
            </div>
            <div class="sidebar-footer">
                <a href="https://geniuskey.github.io/lottery/" class="icon-btn" data-tooltip="ì¶”ì²¨ í¬íƒˆ í™ˆ"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg></a>
                <button class="icon-btn" id="copyResultBtn" data-tooltip-i18n="copyResult" data-tooltip="ê²°ê³¼ ë³µì‚¬"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button>
                <a href="https://github.com/geniuskey/lottery" target="_blank" class="icon-btn" data-tooltip-i18n="github" data-tooltip="GitHub ì €ì¥ì†Œ"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a>
                <a href="https://buymeacoffee.com/euiyun" target="_blank" class="icon-btn" data-tooltip-i18n="coffee" data-tooltip="ì»¤í”¼ ì‚¬ì£¼ê¸° â˜•"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20.216 6.415l-.132-.666c-.119-.598-.388-1.163-1.001-1.379-.197-.069-.42-.098-.57-.241-.152-.143-.196-.366-.231-.572-.065-.378-.125-.756-.192-1.133-.057-.325-.102-.69-.25-.987-.195-.4-.597-.634-.996-.788a5.723 5.723 0 00-.626-.194c-1-.263-2.05-.36-3.077-.416a25.834 25.834 0 00-3.7.062c-.915.083-1.88.184-2.75.5-.318.116-.646.256-.888.501-.297.302-.393.77-.177 1.146.154.267.415.456.692.58.36.162.737.284 1.123.366 1.075.238 2.189.331 3.287.37 1.218.05 2.437.01 3.65-.118.299-.033.598-.073.896-.119.352-.054.578-.513.474-.834-.124-.383-.457-.531-.834-.473-.466.074-.96.108-1.382.146-1.177.08-2.358.082-3.536.006a22.228 22.228 0 01-1.157-.107c-.086-.01-.18-.025-.258-.036-.243-.036-.484-.08-.724-.13-.111-.027-.111-.185 0-.212h.005c.277-.06.557-.108.838-.147h.002c.131-.009.263-.032.394-.048a25.076 25.076 0 013.426-.12c.674.019 1.347.067 2.017.144l.228.031c.267.04.533.088.798.145.392.085.895.113 1.07.542.055.137.08.288.111.431l.319 1.484a.237.237 0 01-.199.284h-.003c-.037.006-.075.01-.112.015a36.704 36.704 0 01-4.743.295 37.059 37.059 0 01-4.699-.304c-.14-.017-.293-.042-.417-.06-.326-.048-.649-.108-.973-.161-.393-.065-.768-.032-1.123.161-.29.16-.527.404-.675.701-.154.316-.199.66-.267 1-.069.34-.176.707-.135 1.056.087.753.613 1.365 1.37 1.502a39.69 39.69 0 0011.343.376.483.483 0 01.535.53l-.071.697-1.018 9.907c-.041.41-.047.832-.125 1.237-.122.637-.553 1.028-1.182 1.171-.577.131-1.165.2-1.756.205-.656.004-1.31-.025-1.966-.022-.699.004-1.556-.06-2.095-.58-.475-.458-.54-1.174-.605-1.793l-.731-7.013-.322-3.094c-.037-.351-.286-.695-.678-.678-.336.015-.718.3-.678.679l.228 2.185.949 9.112c.147 1.344 1.174 2.068 2.446 2.272.742.12 1.503.144 2.257.156.966.016 1.942.053 2.892-.122 1.408-.258 2.465-1.198 2.616-2.657.34-3.332.683-6.663 1.024-9.995l.215-2.087a.484.484 0 01.39-.426c.402-.078.787-.212 1.074-.518.455-.488.546-1.124.385-1.766zm-1.478.772c-.145.137-.363.201-.578.233-2.416.359-4.866.54-7.308.46-1.748-.06-3.477-.254-5.207-.498-.17-.024-.353-.055-.47-.18-.22-.236-.111-.71-.054-.995.052-.26.152-.609.463-.646.484-.057 1.046.148 1.526.22.577.088 1.156.159 1.737.212 2.48.226 5.002.19 7.472-.14.45-.06.899-.13 1.345-.21.399-.072.84-.206 1.08.206.166.281.188.657.162.974a.544.544 0 01-.169.364z"></path></svg></a>
            </div>
        </aside>
        <main class="game-area">
            <div class="arena-header">
                <div class="shrink-warning" id="shrinkWarning">âš ï¸ ì˜ì—­ ì¶•ì†Œ!</div>
                <div class="timer-display" id="timerDisplay">00:00</div>
                <div class="status-bar">
                    <div class="status-item humans">ğŸ§‘ <span id="humanCount">0</span></div>
                    <div class="status-item zombies">ğŸ§Ÿ <span id="zombieCountDisplay">0</span></div>
                </div>
            </div>
            <div class="canvas-wrapper">
                <canvas id="gameCanvas"></canvas>
                <div class="copyright">Â© 2025 Euiyun Edwin Kim</div>
            </div>
        </main>
    </div>
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <h2 class="modal-title" data-i18n="helpTitle">ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜ ê²Œì„</h2>
            <div class="help-section"><h3 data-i18n="helpRulesTitle">ğŸ® ê²Œì„ ê·œì¹™</h3><p data-i18n="helpRules">ì°¸ì—¬ìë“¤ì´ ì•„ë ˆë‚˜ì—ì„œ ì¢€ë¹„ë¥¼ í”¼í•´ ìƒì¡´í•©ë‹ˆë‹¤. ìµœì¢… ìƒì¡´ì ìˆ˜ë§Œí¼ ë‚¨ìœ¼ë©´ ê²Œì„ ì¢…ë£Œ!</p></div>
            <div class="help-section"><h3 data-i18n="helpMovementTitle">ğŸƒ ì´ë™ ì‹œìŠ¤í…œ</h3><p data-i18n="helpMovement">â€¢ ì¸ê°„ì´ ì¢€ë¹„ë¥¼ ë³´ë©´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì „ë ¥ ì§ˆì£¼<br>â€¢ ì¢€ë¹„ëŠ” ì‹œì•¼ê°€ ì¢ì§€ë§Œ ì¸ê°„ë³´ë‹¤ ë©€ë¦¬ ë´…ë‹ˆë‹¤<br>â€¢ ì´ˆê¸° ì¢€ë¹„ëŠ” í•œ ë²ˆ ë¬¼ë©´ ì£½ìŠµë‹ˆë‹¤</p></div>
            <div class="help-section"><h3 data-i18n="helpShrinkTitle">ğŸ”¥ ì˜ì—­ ì¶•ì†Œ</h3><p data-i18n="helpShrink">â€¢ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì˜ì—­ì´ ì¶•ì†Œë©ë‹ˆë‹¤<br>â€¢ ì¢€ë¹„ê°€ 10ë§ˆë¦¬ë¥¼ ì´ˆê³¼í•˜ë©´ ì˜¤ë˜ëœ ì¢€ë¹„ë¶€í„° êµ¶ì–´ ì£½ìŠµë‹ˆë‹¤</p></div>
            <button class="modal-btn" id="closeHelpBtn" data-i18n="understood">ì´í•´í–ˆìŠµë‹ˆë‹¤!</button>
        </div>
    </div>
    <div class="winner-overlay" id="winnerOverlay">
        <div class="winner-title" data-i18n="finalSurvivor">ğŸ† ìµœí›„ì˜ ìƒì¡´ì! ğŸ†</div>
        <div class="winner-name" id="winnerName"></div>
        <div class="winner-stats" id="winnerStats"></div>
        <button class="modal-btn" id="closeWinnerBtn" data-i18n="confirm">í™•ì¸</button>
    </div>
    <div class="toast" id="toast"></div>
    <script>
const i18n={ko:{title:'ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜',participants:'ì°¸ì—¬ì ëª…ë‹¨',participantsPlaceholder:'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”\nì˜ˆ: ì² ìˆ˜, ì˜í¬, ë¯¼ìˆ˜',hint:'ì‰¼í‘œ ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„',initialZombies:'ğŸ§Ÿ ì´ˆê¸° ì¢€ë¹„ ìˆ˜',survivors:'ğŸ† ìµœì¢… ìƒì¡´ì ìˆ˜',start:'ğŸ® ì‹œì‘',infectionOrder:'ğŸ† ê°ì—¼ ìˆœì„œ',rankingPlaceholder:'ê²Œì„ì„ ì‹œì‘í•˜ë©´<br>ê°ì—¼ ìˆœì„œê°€ í‘œì‹œë©ë‹ˆë‹¤',copyResult:'ê²°ê³¼ ë³µì‚¬',github:'GitHub ì €ì¥ì†Œ',coffee:'ì»¤í”¼ ì‚¬ì£¼ê¸° â˜•',finalSurvivor:'ğŸ† ìµœí›„ì˜ ìƒì¡´ì! ğŸ†',survivalTime:'ìƒì¡´ ì‹œê°„: {time}ì´ˆ',confirm:'í™•ì¸',helpTitle:'ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜ ê²Œì„',helpRulesTitle:'ğŸ® ê²Œì„ ê·œì¹™',helpRules:'ì°¸ì—¬ìë“¤ì´ ì•„ë ˆë‚˜ì—ì„œ ì¢€ë¹„ë¥¼ í”¼í•´ ìƒì¡´í•©ë‹ˆë‹¤. ìµœì¢… ìƒì¡´ì ìˆ˜ë§Œí¼ ë‚¨ìœ¼ë©´ ê²Œì„ ì¢…ë£Œ!',helpMovementTitle:'ğŸƒ ì´ë™ ì‹œìŠ¤í…œ',helpMovement:'â€¢ ì¸ê°„ì´ ì¢€ë¹„ë¥¼ ë³´ë©´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì „ë ¥ ì§ˆì£¼<br>â€¢ ì¢€ë¹„ëŠ” ì‹œì•¼ê°€ ì¢ì§€ë§Œ ì¸ê°„ë³´ë‹¤ ë©€ë¦¬ ë´…ë‹ˆë‹¤<br>â€¢ ì´ˆê¸° ì¢€ë¹„ëŠ” í•œ ë²ˆ ë¬¼ë©´ ì£½ìŠµë‹ˆë‹¤',helpShrinkTitle:'ğŸ”¥ ì˜ì—­ ì¶•ì†Œ',helpShrink:'â€¢ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì˜ì—­ì´ ì¶•ì†Œë©ë‹ˆë‹¤<br>â€¢ ì¢€ë¹„ê°€ 10ë§ˆë¦¬ë¥¼ ì´ˆê³¼í•˜ë©´ ì˜¤ë˜ëœ ì¢€ë¹„ë¶€í„° êµ¶ì–´ ì£½ìŠµë‹ˆë‹¤',understood:'ì´í•´í–ˆìŠµë‹ˆë‹¤!',copied:'ğŸ“‹ ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!',copyFailed:'âŒ ë³µì‚¬ ì‹¤íŒ¨',minParticipants:'ìµœì†Œ 2ëª… ì´ìƒì˜ ì°¸ì—¬ìê°€ í•„ìš”í•©ë‹ˆë‹¤!',survivorError:'ìµœì¢… ìƒì¡´ì ìˆ˜ëŠ” ì°¸ì—¬ì ìˆ˜ë³´ë‹¤ ì ì–´ì•¼ í•©ë‹ˆë‹¤!',initialZombie:'ì´ˆê¸° ì¢€ë¹„',infected:'ê°ì—¼',survivor:'ìƒì¡´',winner:'ìŠ¹ë¦¬!',resultTitle:'ğŸ§Ÿ ì¢€ë¹„ ì•„ë ˆë‚˜ ê²°ê³¼ ğŸ§Ÿ',gameTime:'â±ï¸ ê²Œì„ ì‹œê°„: {time}ì´ˆ',finalSurvivors:'ğŸ† ìµœì¢… ìƒì¡´ì',infectionOrderResult:'ğŸ’€ ê°ì—¼ ìˆœì„œ',zombieNames:['ì¢€ë¹„A','ì¢€ë¹„B','ì¢€ë¹„C','ì¢€ë¹„D','ì¢€ë¹„E','ì¢€ë¹„F','ì¢€ë¹„G','ì¢€ë¹„H','ì¢€ë¹„I','ì¢€ë¹„J'],shrinkWarning:'âš ï¸ ì˜ì—­ ì¶•ì†Œ!',infectMessage:'{attacker}ê°€ {victim}ì„(ë¥¼) ë¬¼ì—ˆìŠµë‹ˆë‹¤!',zombieDied:'{name}ê°€ êµ¶ì–´ ì£½ì—ˆìŠµë‹ˆë‹¤.'},en:{title:'ğŸ§Ÿ Zombie Arena',participants:'Participants',participantsPlaceholder:'Enter names\nEx: John, Jane, Mike',hint:'Separate by comma or newline',initialZombies:'ğŸ§Ÿ Initial Zombies',survivors:'ğŸ† Final Survivors',start:'ğŸ® Start',infectionOrder:'ğŸ† Infection Order',rankingPlaceholder:'Start the game to see<br>the infection order',copyResult:'Copy Result',github:'GitHub Repository',coffee:'Buy Coffee â˜•',finalSurvivor:'ğŸ† Final Survivor! ğŸ†',survivalTime:'Survival Time: {time}s',confirm:'OK',helpTitle:'ğŸ§Ÿ Zombie Arena Game',helpRulesTitle:'ğŸ® Game Rules',helpRules:'Participants survive in the arena while avoiding zombies. Game ends when only the final survivors remain!',helpMovementTitle:'ğŸƒ Movement System',helpMovement:'â€¢ Humans sprint away when spotting zombies<br>â€¢ Zombies have narrow but longer vision than humans<br>â€¢ Initial zombies die after one bite',helpShrinkTitle:'ğŸ”¥ Zone Shrinking',helpShrink:'â€¢ The zone shrinks over time<br>â€¢ When zombies exceed 10, oldest zombies starve',understood:'Got it!',copied:'ğŸ“‹ Result copied!',copyFailed:'âŒ Copy failed',minParticipants:'At least 2 participants required!',survivorError:'Final survivors must be less than total participants!',initialZombie:'Initial Zombie',infected:'Infected',survivor:'Alive',winner:'Winner!',resultTitle:'ğŸ§Ÿ Zombie Arena Result ğŸ§Ÿ',gameTime:'â±ï¸ Game Time: {time}s',finalSurvivors:'ğŸ† Final Survivors',infectionOrderResult:'ğŸ’€ Infection Order',zombieNames:['Zombie A','Zombie B','Zombie C','Zombie D','Zombie E','Zombie F','Zombie G','Zombie H','Zombie I','Zombie J'],shrinkWarning:'âš ï¸ Zone Shrinking!',infectMessage:'{attacker} bit {victim}!',zombieDied:'{name} starved to death.'},zh:{title:'ğŸ§Ÿ åƒµå°¸ç«æŠ€åœº',participants:'å‚ä¸è€…åå•',participantsPlaceholder:'è¾“å…¥å§“å\nä¾‹ï¼šå°æ˜ï¼Œå°çº¢ï¼Œå°åˆš',hint:'ç”¨é€—å·æˆ–æ¢è¡Œåˆ†éš”',initialZombies:'ğŸ§Ÿ åˆå§‹åƒµå°¸æ•°',survivors:'ğŸ† æœ€ç»ˆå¹¸å­˜è€…æ•°',start:'ğŸ® å¼€å§‹',infectionOrder:'ğŸ† æ„ŸæŸ“é¡ºåº',rankingPlaceholder:'å¼€å§‹æ¸¸æˆå<br>å°†æ˜¾ç¤ºæ„ŸæŸ“é¡ºåº',copyResult:'å¤åˆ¶ç»“æœ',github:'GitHub ä»“åº“',coffee:'è¯·å–å’–å•¡ â˜•',finalSurvivor:'ğŸ† æœ€åçš„å¹¸å­˜è€…ï¼ğŸ†',survivalTime:'ç”Ÿå­˜æ—¶é—´ï¼š{time}ç§’',confirm:'ç¡®å®š',helpTitle:'ğŸ§Ÿ åƒµå°¸ç«æŠ€åœºæ¸¸æˆ',helpRulesTitle:'ğŸ® æ¸¸æˆè§„åˆ™',helpRules:'å‚ä¸è€…åœ¨ç«æŠ€åœºä¸­èº²é¿åƒµå°¸ç”Ÿå­˜ã€‚å½“åªå‰©ä¸‹æœ€ç»ˆå¹¸å­˜è€…æ•°é‡æ—¶æ¸¸æˆç»“æŸï¼',helpMovementTitle:'ğŸƒ ç§»åŠ¨ç³»ç»Ÿ',helpMovement:'â€¢ äººç±»çœ‹åˆ°åƒµå°¸æ—¶ä¼šå†²åˆºé€ƒè·‘<br>â€¢ åƒµå°¸è§†é‡çª„ä½†æ¯”äººç±»çœ‹å¾—è¿œ<br>â€¢ åˆå§‹åƒµå°¸å’¬ä¸€æ¬¡åä¼šæ­»äº¡',helpShrinkTitle:'ğŸ”¥ åŒºåŸŸç¼©å°',helpShrink:'â€¢ éšæ—¶é—´æ¨ç§»åŒºåŸŸä¼šç¼©å°<br>â€¢ åƒµå°¸è¶…è¿‡10åªæ—¶ï¼Œæœ€è€çš„åƒµå°¸ä¼šé¥¿æ­»',understood:'æ˜ç™½äº†ï¼',copied:'ğŸ“‹ ç»“æœå·²å¤åˆ¶ï¼',copyFailed:'âŒ å¤åˆ¶å¤±è´¥',minParticipants:'è‡³å°‘éœ€è¦2åå‚ä¸è€…ï¼',survivorError:'æœ€ç»ˆå¹¸å­˜è€…æ•°å¿…é¡»å°‘äºå‚ä¸è€…æ€»æ•°ï¼',initialZombie:'åˆå§‹åƒµå°¸',infected:'æ„ŸæŸ“',survivor:'å­˜æ´»',winner:'èƒœåˆ©ï¼',resultTitle:'ğŸ§Ÿ åƒµå°¸ç«æŠ€åœºç»“æœ ğŸ§Ÿ',gameTime:'â±ï¸ æ¸¸æˆæ—¶é—´ï¼š{time}ç§’',finalSurvivors:'ğŸ† æœ€ç»ˆå¹¸å­˜è€…',infectionOrderResult:'ğŸ’€ æ„ŸæŸ“é¡ºåº',zombieNames:['åƒµå°¸A','åƒµå°¸B','åƒµå°¸C','åƒµå°¸D','åƒµå°¸E','åƒµå°¸F','åƒµå°¸G','åƒµå°¸H','åƒµå°¸I','åƒµå°¸J'],shrinkWarning:'âš ï¸ åŒºåŸŸç¼©å°ï¼',infectMessage:'{attacker}å’¬äº†{victim}ï¼',zombieDied:'{name}é¥¿æ­»äº†ã€‚'}};
let currentLang='ko';
function detectLanguage(){const b=navigator.language||navigator.userLanguage;const l=b.split('-')[0].toLowerCase();return i18n[l]?l:'en'}
function t(k,p={}){let x=i18n[currentLang][k]||i18n['en'][k]||k;Object.keys(p).forEach(n=>{x=x.replace('{'+n+'}',p[n])});return x}
function updateUI18n(){document.querySelectorAll('[data-i18n]').forEach(e=>e.innerHTML=t(e.getAttribute('data-i18n')));document.querySelectorAll('[data-placeholder-i18n]').forEach(e=>e.placeholder=t(e.getAttribute('data-placeholder-i18n')));document.querySelectorAll('[data-tooltip-i18n]').forEach(e=>e.setAttribute('data-tooltip',t(e.getAttribute('data-tooltip-i18n'))));document.getElementById('shrinkWarning').textContent=t('shrinkWarning')}
class ZombieSurvival{constructor(c){this.canvas=c;this.ctx=c.getContext('2d');this.participants=[];this.entities=[];this.deadZombies=[];this.infectedOrder=[];this.notifications=[];this.isRunning=false;this.gameStarted=false;this.startTime=0;this.endTime=0;this.zombieCount=2;this.survivorCount=1;this.entityRadius=10;this.maxZombies=10;this.humanWalkSpeed=0.6;this.humanRunSpeed=2.5;this.zombieWalkSpeed=0.5;this.zombieChaseSpeed=2.0;this.humanFovAngle=140;this.zombieFovAngle=80;this.zombieDetectRange=250;this.humanDetectRange=this.zombieDetectRange*0.9;this.runDuration=60;this.humanColors=['#4CAF50','#2196F3','#FF9800','#9C27B0','#00BCD4','#FFEB3B','#E91E63','#3F51B5','#009688','#FF5722','#607D8B','#8BC34A'];this.centerX=0;this.centerY=0;this.currentRadius=0;this.targetRadius=0;this.targetCenterX=0;this.targetCenterY=0;this.shrinkPhase=0;this.shrinkTimer=0;this.shrinkInterval=600;this.shrinkWarningTime=180;this.isShrinking=false;this.setupCanvas();this.bindEvents()}
get zombieNames(){return t('zombieNames')}
setupCanvas(){const w=this.canvas.parentElement;this.canvas.width=w.clientWidth;this.canvas.height=w.clientHeight;this.centerX=this.canvas.width/2;this.centerY=this.canvas.height/2;this.currentRadius=Math.min(this.canvas.width,this.canvas.height)/2-15;this.targetRadius=this.currentRadius;this.targetCenterX=this.centerX;this.targetCenterY=this.centerY}
bindEvents(){let rt;window.addEventListener('resize',()=>{clearTimeout(rt);rt=setTimeout(()=>{const oW=this.canvas.width,oH=this.canvas.height;this.setupCanvas();if(!this.isRunning)this.redistributeEntities(oW,oH);this.draw()},100)})}
redistributeEntities(oW,oH){const sX=this.canvas.width/oW,sY=this.canvas.height/oH;for(const e of this.entities){e.x*=sX;e.y*=sY}}
setParticipants(n){this.participants=n.filter(x=>x.trim());this.reset()}
reset(){this.isRunning=false;this.gameStarted=false;this.entities=[];this.deadZombies=[];this.infectedOrder=[];this.notifications=[];this.startTime=0;this.endTime=0;this.shrinkPhase=0;this.shrinkTimer=0;this.isShrinking=false;this.setupCanvas();this.setupEntities(false);this.draw();this.updateUI();this.updateRanking();document.getElementById('shrinkWarning').style.display='none';document.getElementById('timerDisplay').textContent='00:00'}
setupEntities(incZ=true){this.entities=[];const sh=[...this.participants].sort(()=>Math.random()-0.5);const tc=incZ?sh.length+this.zombieCount:sh.length;const pos=this.generateSpacedPositions(tc);for(let i=0;i<sh.length;i++){this.entities.push({name:sh[i],x:pos[i].x,y:pos[i].y,vx:0,vy:0,angle:Math.random()*Math.PI*2,isZombie:false,isRunning:false,runTimer:0,color:this.humanColors[i%this.humanColors.length],targetAngle:Math.random()*Math.PI*2,wanderTimer:Math.random()*120,hasTarget:false,isInitialZombie:false,isTransforming:false,transformTimer:0,eatingTimer:0,zombieKills:0,zombifiedAt:0,helpTimer:0})}if(incZ){for(let i=0;i<this.zombieCount;i++){const p=pos[sh.length+i];this.entities.push({name:this.zombieNames[i]||('Zombie '+(i+1)),x:p.x,y:p.y,vx:0,vy:0,angle:Math.random()*Math.PI*2,isZombie:true,isRunning:false,runTimer:0,color:'#666',targetAngle:Math.random()*Math.PI*2,wanderTimer:Math.random()*120,hasTarget:false,isInitialZombie:true,isTransforming:false,transformTimer:0,eatingTimer:0,zombieKills:0,zombifiedAt:Date.now(),helpTimer:0})}}}
generateSpacedPositions(c){const pos=[],pad=30;for(let i=0;i<c;i++){let best=null,bestD=0;for(let a=0;a<50;a++){const ang=Math.random()*Math.PI*2;const d=Math.random()*(this.currentRadius-pad);const p={x:this.centerX+Math.cos(ang)*d,y:this.centerY+Math.sin(ang)*d};let minD=Infinity;for(const o of pos){const dx=p.x-o.x,dy=p.y-o.y;minD=Math.min(minD,Math.sqrt(dx*dx+dy*dy))}if(minD>bestD){bestD=minD;best=p}if(minD>=50)break}pos.push(best||{x:this.centerX+(Math.random()-0.5)*this.currentRadius,y:this.centerY+(Math.random()-0.5)*this.currentRadius})}return pos}
addNotification(m){this.notifications.push({text:m,timer:180,opacity:1})}
updateNotifications(){for(let i=this.notifications.length-1;i>=0;i--){this.notifications[i].timer--;if(this.notifications[i].timer<30)this.notifications[i].opacity=this.notifications[i].timer/30;if(this.notifications[i].timer<=0)this.notifications.splice(i,1)}while(this.notifications.length>5)this.notifications.shift()}
start(){if(this.participants.length<2){alert(t('minParticipants'));return}this.reset();this.setupEntities(true);this.gameStarted=true;this.isRunning=true;this.startTime=Date.now();this.endTime=0;this.setControlsDisabled(true);this.draw();this.gameLoop()}
stop(){this.isRunning=false;this.setControlsDisabled(false)}
setControlsDisabled(d){document.getElementById('zombieCount').disabled=d;document.getElementById('survivorCount').disabled=d}
gameLoop(){if(!this.isRunning)return;this.update();this.draw();this.updateUI();const h=this.entities.filter(e=>!e.isZombie&&!e.isTransforming);if(h.length<=this.survivorCount&&this.isRunning){this.endGame(h);return}requestAnimationFrame(()=>this.gameLoop())}
getWallAvoidanceAngle(e){const dx=e.x-this.centerX,dy=e.y-this.centerY;const d=Math.sqrt(dx*dx+dy*dy);if(this.currentRadius-d<50)return Math.atan2(-dy,-dx);return null}
getEscapeAngle(h,z){const dx=h.x-z.x,dy=h.y-z.y;let ea=Math.atan2(dy,dx);const tx=h.x+Math.cos(ea)*100;const ty=h.y+Math.sin(ea)*100;const td=Math.sqrt(Math.pow(tx-this.centerX,2)+Math.pow(ty-this.centerY,2));if(td>this.currentRadius-20){const tc=Math.atan2(this.centerY-h.y,this.centerX-h.x);const cr=dx*(this.centerY-h.y)-dy*(this.centerX-h.x);ea=tc+(cr>0?Math.PI/2:-Math.PI/2)}return ea+(Math.random()-0.5)*0.3}
update(){this.updateShrinking();this.updateTransformations();this.updateNotifications();this.updateDeadZombies();const h=this.entities.filter(e=>!e.isZombie&&!e.isTransforming);const z=this.entities.filter(e=>e.isZombie);this.checkZombieLimit();for(const e of this.entities){if(e.isTransforming)continue;if(e.helpTimer>0)e.helpTimer--;if(e.eatingTimer>0){e.eatingTimer--;e.vx=0;e.vy=0;continue}if(e.isZombie)this.updateZombie(e,h);else this.updateHuman(e,z);e.x+=e.vx;e.y+=e.vy;e.vx*=0.95;e.vy*=0.95;const dx=e.x-this.centerX,dy=e.y-this.centerY;const df=Math.sqrt(dx*dx+dy*dy);const md=this.currentRadius-this.entityRadius;if(df>md){const a=Math.atan2(dy,dx);e.x=this.centerX+Math.cos(a)*md;e.y=this.centerY+Math.sin(a)*md;const nx=dx/df,ny=dy/df;const dot=e.vx*nx+e.vy*ny;e.vx-=2*dot*nx*0.5;e.vy-=2*dot*ny*0.5}}this.checkInfections(h,z);this.handleCollisions()}
checkZombieLimit(){const z=this.entities.filter(e=>e.isZombie&&!e.isInitialZombie);if(z.length>this.maxZombies){z.sort((a,b)=>a.zombifiedAt-b.zombifiedAt);const tk=z.length-this.maxZombies;for(let i=0;i<tk;i++){const zb=z[i];this.addNotification(t('zombieDied',{name:zb.name}));this.deadZombies.push({...zb,fadeTimer:60});const idx=this.entities.indexOf(zb);if(idx>-1)this.entities.splice(idx,1)}}}
updateDeadZombies(){for(let i=this.deadZombies.length-1;i>=0;i--){this.deadZombies[i].fadeTimer--;if(this.deadZombies[i].fadeTimer<=0)this.deadZombies.splice(i,1)}}
updateTransformations(){for(const e of this.entities){if(e.isTransforming){e.transformTimer--;if(e.transformTimer<=0){e.isTransforming=false;e.isZombie=true;e.color='#666';e.hasTarget=false;e.wanderTimer=60;e.zombifiedAt=Date.now()}}}}
startTransformation(e,c,inf=null){if(e.isTransforming||e.isZombie)return;e.isTransforming=true;e.transformTimer=60;e.vx=0;e.vy=0;if(inf){inf.eatingTimer=30;inf.vx=0;inf.vy=0;inf.zombieKills++;this.addNotification(t('infectMessage',{attacker:inf.name,victim:e.name}));if(inf.isInitialZombie&&inf.zombieKills>=1){const i=inf;setTimeout(()=>{this.deadZombies.push({...i,fadeTimer:60});const idx=this.entities.indexOf(i);if(idx>-1)this.entities.splice(idx,1)},500)}}this.infectedOrder.push({name:e.name,time:Date.now()-this.startTime,cause:c});this.updateRanking()}
updateShrinking(){this.shrinkTimer++;const w=document.getElementById('shrinkWarning');if(this.shrinkTimer>this.shrinkInterval-this.shrinkWarningTime&&this.shrinkTimer<this.shrinkInterval){w.style.display='block'}else{w.style.display='none'}if(this.shrinkTimer>=this.shrinkInterval){this.shrinkTimer=0;this.shrinkPhase++;const mo=this.currentRadius*0.3;const oa=Math.random()*Math.PI*2;const od=Math.random()*mo;this.targetCenterX=this.centerX+Math.cos(oa)*od;this.targetCenterY=this.centerY+Math.sin(oa)*od;const mr=Math.min(50,this.currentRadius*0.5);const sa=Math.min(30+this.shrinkPhase*15,this.currentRadius*0.3);this.targetRadius=Math.max(mr,this.currentRadius-sa);const mg=this.targetRadius+10;this.targetCenterX=Math.max(mg,Math.min(this.canvas.width-mg,this.targetCenterX));this.targetCenterY=Math.max(mg,Math.min(this.canvas.height-mg,this.targetCenterY));this.isShrinking=true}if(this.isShrinking){const sp=0.016;this.centerX+=(this.targetCenterX-this.centerX)*sp;this.centerY+=(this.targetCenterY-this.centerY)*sp;this.currentRadius+=(this.targetRadius-this.currentRadius)*sp;if(Math.abs(this.currentRadius-this.targetRadius)<1){this.currentRadius=this.targetRadius;this.centerX=this.targetCenterX;this.centerY=this.targetCenterY;this.isShrinking=false}}}
isInFieldOfView(v,tg,fa){const dx=tg.x-v.x,dy=tg.y-v.y;const at=Math.atan2(dy,dx);let ad=at-v.angle;while(ad>Math.PI)ad-=Math.PI*2;while(ad<-Math.PI)ad+=Math.PI*2;return Math.abs(ad)<(fa/2)*(Math.PI/180)}
updateZombie(z,h){if(h.length===0)return;const wa=this.getWallAvoidanceAngle(z);if(wa!==null&&!z.hasTarget)z.targetAngle=wa;let cv=null,cvd=Infinity;for(const hu of h){const dx=hu.x-z.x,dy=hu.y-z.y;const d=Math.sqrt(dx*dx+dy*dy);if(d<this.zombieDetectRange&&this.isInFieldOfView(z,hu,this.zombieFovAngle)){if(d<cvd){cvd=d;cv=hu}}}if(cv){z.hasTarget=true;const dx=cv.x-z.x,dy=cv.y-z.y;const ta=Math.atan2(dy,dx);let ad=ta-z.angle;while(ad>Math.PI)ad-=Math.PI*2;while(ad<-Math.PI)ad+=Math.PI*2;z.angle+=ad*0.12;z.vx=Math.cos(z.angle)*this.zombieChaseSpeed;z.vy=Math.sin(z.angle)*this.zombieChaseSpeed}else{z.hasTarget=false;z.wanderTimer--;if(z.wanderTimer<=0){z.targetAngle=wa!==null?wa:Math.random()*Math.PI*2;z.wanderTimer=60+Math.random()*120}let ad=z.targetAngle-z.angle;while(ad>Math.PI)ad-=Math.PI*2;while(ad<-Math.PI)ad+=Math.PI*2;z.angle+=ad*0.03;z.vx=Math.cos(z.angle)*this.zombieWalkSpeed;z.vy=Math.sin(z.angle)*this.zombieWalkSpeed}}
updateHuman(h,zs){if(h.runTimer>0)h.runTimer--;const wa=this.getWallAvoidanceAngle(h);if(wa!==null&&!h.isRunning)h.targetAngle=wa;let nvz=null,nd=Infinity;for(const z of zs){const dx=z.x-h.x,dy=z.y-h.y;const d=Math.sqrt(dx*dx+dy*dy);if(d<this.humanDetectRange&&this.isInFieldOfView(h,z,this.humanFovAngle)){if(d<nd){nd=d;nvz=z}}}if(nvz){h.angle=this.getEscapeAngle(h,nvz);h.runTimer=this.runDuration;h.isRunning=true;h.helpTimer=45}if(h.runTimer>0){h.isRunning=true;h.vx=Math.cos(h.angle)*this.humanRunSpeed;h.vy=Math.sin(h.angle)*this.humanRunSpeed}else{h.isRunning=false;h.wanderTimer--;if(h.wanderTimer<=0){h.targetAngle=wa!==null?wa:Math.random()*Math.PI*2;h.wanderTimer=60+Math.random()*120}let ad=h.targetAngle-h.angle;while(ad>Math.PI)ad-=Math.PI*2;while(ad<-Math.PI)ad+=Math.PI*2;h.angle+=ad*0.04;h.vx=Math.cos(h.angle)*this.humanWalkSpeed;h.vy=Math.sin(h.angle)*this.humanWalkSpeed}}
checkInfections(hs,zs){for(const h of hs){for(const z of zs){if(z.eatingTimer>0)continue;const dx=h.x-z.x,dy=h.y-z.y;if(Math.sqrt(dx*dx+dy*dy)<this.entityRadius*2.2){this.startTransformation(h,t('infected'),z)}}}}
handleCollisions(){for(let i=0;i<this.entities.length;i++){for(let j=i+1;j<this.entities.length;j++){const a=this.entities[i],b=this.entities[j];if(a.isZombie!==b.isZombie)continue;const dx=b.x-a.x,dy=b.y-a.y;const d=Math.sqrt(dx*dx+dy*dy);const md=this.entityRadius*2.2;if(d<md&&d>0){const ol=(md-d)/2;const nx=dx/d,ny=dy/d;a.x-=nx*ol*0.5;a.y-=ny*ol*0.5;b.x+=nx*ol*0.5;b.y+=ny*ol*0.5}}}}
draw(){const c=this.ctx;c.fillStyle='#0a0f0a';c.fillRect(0,0,this.canvas.width,this.canvas.height);c.fillStyle='rgba(255,0,0,0.15)';c.fillRect(0,0,this.canvas.width,this.canvas.height);c.save();c.beginPath();c.arc(this.centerX,this.centerY,this.currentRadius,0,Math.PI*2);c.fillStyle='#111a11';c.fill();c.clip();c.strokeStyle='rgba(100,255,100,0.08)';c.lineWidth=1;for(let x=0;x<this.canvas.width;x+=40){c.beginPath();c.moveTo(x,0);c.lineTo(x,this.canvas.height);c.stroke()}for(let y=0;y<this.canvas.height;y+=40){c.beginPath();c.moveTo(0,y);c.lineTo(this.canvas.width,y);c.stroke()}c.restore();c.beginPath();c.arc(this.centerX,this.centerY,this.currentRadius,0,Math.PI*2);c.strokeStyle=this.isShrinking?'#ff4444':'rgba(100,255,100,0.5)';c.lineWidth=this.isShrinking?4:2;c.stroke();if(this.shrinkTimer>this.shrinkInterval-this.shrinkWarningTime){c.beginPath();c.arc(this.targetCenterX,this.targetCenterY,this.targetRadius,0,Math.PI*2);c.strokeStyle='rgba(255,100,100,0.5)';c.setLineDash([5,5]);c.stroke();c.setLineDash([])}for(const d of this.deadZombies)this.drawDeadZombie(d);const h=this.entities.filter(e=>!e.isZombie);const z=this.entities.filter(e=>e.isZombie);for(const e of h)this.drawEntity(e);for(const e of z)this.drawEntity(e);this.drawNotifications()}
drawDeadZombie(d){const c=this.ctx,a=d.fadeTimer/60;c.save();c.globalAlpha=a;c.translate(d.x,d.y);c.rotate(d.angle);c.fillStyle='#3a3a3a';c.beginPath();c.ellipse(0,0,this.entityRadius,this.entityRadius*0.5,0,0,Math.PI*2);c.fill();c.restore()}
drawNotifications(){const c=this.ctx,sx=this.canvas.width-10,sy=10;c.textAlign='right';c.font='bold 12px "Noto Sans KR"';this.notifications.forEach((n,i)=>{const y=sy+i*25;c.globalAlpha=n.opacity;c.fillStyle='#ff6666';c.strokeStyle='rgba(0,0,0,0.8)';c.lineWidth=3;c.strokeText(n.text,sx-5,y+12);c.fillText(n.text,sx-5,y+12)});c.globalAlpha=1;c.textAlign='left'}
drawEntity(e){const c=this.ctx,x=e.x,y=e.y,r=this.entityRadius;c.save();c.translate(x,y);if(e.isTransforming){const p=1-(e.transformTimer/60);const ps=1+Math.sin(p*Math.PI*6)*0.2;c.scale(ps,ps);const gr=Math.floor(p*255);c.fillStyle='rgb('+(100+gr)+','+(150-gr*0.5)+','+(100-gr*0.3)+')';const sh=(1-p)*3;c.translate(Math.random()*sh-sh/2,Math.random()*sh-sh/2);c.beginPath();c.ellipse(0,0,r,r*0.7,0,0,Math.PI*2);c.fill();c.fillStyle='rgb('+(150+gr*0.4)+','+(180-gr*0.5)+','+(150-gr*0.4)+')';c.beginPath();c.arc(r*0.35,0,r*0.35,0,Math.PI*2);c.fill();c.strokeStyle='rgba(255,'+(255-gr)+',0,'+(0.8-p*0.5)+')';c.lineWidth=3;c.beginPath();c.arc(0,0,r+8+p*5,0,Math.PI*2*p);c.stroke();c.restore();c.font='bold '+Math.max(12,r*1.2)+'px "Noto Sans KR"';c.textAlign='center';c.textBaseline='top';c.strokeStyle='rgba(0,0,0,0.9)';c.lineWidth=3;c.strokeText('ğŸ§Ÿ'+e.name,x,y+r+5);c.fillStyle='#ffaa00';c.fillText('ğŸ§Ÿ'+e.name,x,y+r+5);return}if(e.isZombie){if(e.eatingTimer>0){c.fillStyle='rgba(255,0,0,0.3)';c.beginPath();c.arc(0,0,r+5,0,Math.PI*2);c.fill()}if(!e.hasTarget&&e.eatingTimer<=0){c.rotate(e.angle);const fr=(this.zombieFovAngle/2)*(Math.PI/180);c.fillStyle='rgba(255,50,50,0.08)';c.beginPath();c.moveTo(0,0);c.arc(0,0,this.zombieDetectRange,-fr,fr);c.closePath();c.fill();c.rotate(-e.angle)}c.rotate(e.angle);c.fillStyle='#4a5d4a';c.beginPath();c.ellipse(0,0,r,r*0.7,0,0,Math.PI*2);c.fill();c.fillStyle='#5a6b5a';c.beginPath();c.arc(r*0.4,0,r*0.4,0,Math.PI*2);c.fill();c.fillStyle=e.hasTarget?'#ff0000':'#ff4444';c.beginPath();c.arc(r*0.5,-r*0.1,r*0.1,0,Math.PI*2);c.arc(r*0.5,r*0.1,r*0.1,0,Math.PI*2);c.fill()}else{c.rotate(e.angle);const fr=(this.humanFovAngle/2)*(Math.PI/180);c.fillStyle='rgba(255,255,100,0.05)';c.beginPath();c.moveTo(0,0);c.arc(0,0,this.humanDetectRange,-fr,fr);c.closePath();c.fill();c.fillStyle=e.color;c.beginPath();c.ellipse(0,0,r,r*0.65,0,0,Math.PI*2);c.fill();c.fillStyle='#FFDAB9';c.beginPath();c.arc(r*0.35,0,r*0.35,0,Math.PI*2);c.fill();c.fillStyle='#333';c.beginPath();c.arc(r*0.25,0,r*0.3,Math.PI*0.7,-Math.PI*0.7);c.fill();if(e.isRunning){c.rotate(-e.angle);c.strokeStyle='#ffff00';c.lineWidth=2;c.beginPath();c.arc(0,0,r+3,0,Math.PI*2*(e.runTimer/this.runDuration));c.stroke()}}c.restore();if(e.helpTimer>0&&!e.isZombie){const sh=Math.sin(Date.now()/30)*3;const hy=y-r-20+sh,hx=x+Math.sin(Date.now()/50)*2;c.font='bold 14px "Noto Sans KR"';c.textAlign='center';c.textBaseline='bottom';c.shadowColor='rgba(255,0,0,0.3)';c.shadowBlur=3;c.strokeStyle='rgba(0,0,0,0.9)';c.lineWidth=3;c.strokeText('Help!!',hx,hy);c.fillStyle='#ff4444';c.fillText('Help!!',hx,hy);c.shadowBlur=0}c.font='bold '+Math.max(12,r*1.2)+'px "Noto Sans KR"';c.textAlign='center';c.textBaseline='top';const sn=e.name.length>6?e.name.slice(0,5)+'..':e.name;c.strokeStyle='rgba(0,0,0,0.9)';c.lineWidth=3;c.strokeText(sn,x,y+r+5);c.fillStyle=e.isZombie?'#ff6666':'#fff';c.fillText(sn,x,y+r+5)}
endGame(w){this.isRunning=false;this.endTime=Date.now();this.setControlsDisabled(false);document.getElementById('shrinkWarning').style.display='none';this.updateUI();if(w&&w.length>0){const st=((this.endTime-this.startTime)/1000).toFixed(1);const wn=w.map(x=>x.name).join(', ');document.getElementById('winnerName').textContent=wn;document.getElementById('winnerStats').textContent=t('survivalTime',{time:st});document.getElementById('winnerOverlay').classList.add('show')}this.updateRanking()}
updateRanking(){const l=document.getElementById('rankingList');if(this.infectedOrder.length===0&&!this.isRunning){l.innerHTML='<div class="ranking-placeholder">'+t('rankingPlaceholder')+'</div>';return}let h='';const sv=this.entities.filter(e=>!e.isZombie&&!e.isTransforming);sv.forEach(s=>{const iw=sv.length<=this.survivorCount&&!this.isRunning;h+='<div class="ranking-item '+(iw?'winner':'survivor')+'"><span class="ranking-rank">'+(iw?'ğŸ†':'ğŸ§‘')+'</span><span class="ranking-name">'+s.name+'</span><span class="ranking-status">'+(iw?t('winner'):t('survivor'))+'</span></div>'});if(sv.length>0&&this.infectedOrder.length>0){h+='<div class="ranking-divider"></div>'}const ri=[...this.infectedOrder].reverse();ri.forEach((inf)=>{const oi=this.infectedOrder.indexOf(inf);const tm=(inf.time/1000).toFixed(1);h+='<div class="ranking-item infected"><span class="ranking-rank">'+(oi+1)+'</span><span class="ranking-name">ğŸ§Ÿ '+inf.name+'</span><span class="ranking-status">'+tm+'s</span></div>'});const iz=this.entities.filter(e=>e.isInitialZombie);if(iz.length>0){h+='<div style="border-top:1px solid rgba(255,255,255,0.1);margin:6px 0;padding-top:6px;font-size:0.6rem;color:#666">'+t('initialZombie')+'</div>';iz.forEach(z=>{h+='<div class="ranking-item infected" style="opacity:0.6"><span class="ranking-rank">ğŸ§Ÿ</span><span class="ranking-name">'+z.name+'</span><span class="ranking-status">-</span></div>'})}l.innerHTML=h}
updateUI(){const h=this.entities.filter(e=>!e.isZombie&&!e.isTransforming);const z=this.entities.filter(e=>e.isZombie);document.getElementById('humanCount').textContent=h.length;document.getElementById('zombieCountDisplay').textContent=z.length;if(this.isRunning){const el=Math.floor((Date.now()-this.startTime)/1000);const m=Math.floor(el/60).toString().padStart(2,'0');const s=(el%60).toString().padStart(2,'0');document.getElementById('timerDisplay').textContent=m+':'+s}}
getResultText(){const et=this.endTime||Date.now();const el=this.startTime?((et-this.startTime)/1000).toFixed(1):0;let r=t('resultTitle')+'\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\n'+t('gameTime',{time:el})+'\n\n';const sv=this.entities.filter(e=>!e.isZombie&&!e.isTransforming);if(sv.length>0){r+=t('finalSurvivors')+'\n';sv.forEach(s=>{r+='   '+s.name+'\n'});r+='\n'}if(this.infectedOrder.length>0){r+=t('infectionOrderResult')+'\n';this.infectedOrder.forEach((inf,i)=>{const tm=(inf.time/1000).toFixed(1);r+='   '+(i+1)+'. '+inf.name+' ('+tm+'s)\n'})}r+='\nğŸ® https://github.com/geniuskey/lottery';return r}}
function showToast(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000)}
document.addEventListener('DOMContentLoaded',()=>{currentLang=localStorage.getItem('zombie-arena-lang')||detectLanguage();document.getElementById('langSelect').value=currentLang;updateUI18n();const cv=document.getElementById('gameCanvas');const g=new ZombieSurvival(cv);const pi=document.getElementById('participants');const zcs=document.getElementById('zombieCount');const zvd=document.getElementById('zombieValue');const scs=document.getElementById('survivorCount');const svd=document.getElementById('survivorValue');document.getElementById('langSelect').addEventListener('change',(e)=>{currentLang=e.target.value;localStorage.setItem('zombie-arena-lang',currentLang);updateUI18n();g.updateRanking()});function pp(t){return t.split(/[\n,]+/).map(s=>s.trim()).filter(Boolean)}function ug(){g.setParticipants(pp(pi.value))}pi.addEventListener('input',()=>{ug();localStorage.setItem('zombie-arena-participants',pi.value)});zcs.addEventListener('input',()=>{zvd.textContent=zcs.value;g.zombieCount=parseInt(zcs.value);if(!g.isRunning)g.reset()});scs.addEventListener('input',()=>{svd.textContent=scs.value;g.survivorCount=parseInt(scs.value)});document.getElementById('startBtn').addEventListener('click',()=>{const p=pp(pi.value);if(p.length<2){alert(t('minParticipants'));return}if(g.survivorCount>=p.length){alert(t('survivorError'));return}g.setParticipants(p);g.start()});document.getElementById('resetBtn').addEventListener('click',()=>{g.stop();g.reset()});document.getElementById('helpBtn').addEventListener('click',()=>document.getElementById('helpModal').classList.add('show'));document.getElementById('closeHelpBtn').addEventListener('click',()=>document.getElementById('helpModal').classList.remove('show'));document.getElementById('helpModal').addEventListener('click',(e)=>{if(e.target.id==='helpModal')document.getElementById('helpModal').classList.remove('show')});document.getElementById('closeWinnerBtn').addEventListener('click',()=>document.getElementById('winnerOverlay').classList.remove('show'));document.getElementById('copyResultBtn').addEventListener('click',()=>{navigator.clipboard.writeText(g.getResultText()).then(()=>showToast(t('copied'))).catch(()=>showToast(t('copyFailed')))});const sv=localStorage.getItem('zombie-arena-participants');if(sv){pi.value=sv;ug()}g.draw()});
    </script>
</body>
</html>
